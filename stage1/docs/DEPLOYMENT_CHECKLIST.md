# 部署檢查清單

**版本**: v1.0  
**日期**: 2025-10-13  
**專案**: Prompt-Scribe 資料庫部署  

---

## 📋 部署前檢查清單

### 🔍 環境準備
- [ ] **目標環境確認**
  - [ ] 伺服器資源充足 (CPU, 記憶體, 磁碟空間)
  - [ ] 網路連接正常
  - [ ] 權限設置正確

- [ ] **資料庫文件準備**
  - [ ] `output/tags.db` 文件存在且完整
  - [ ] 資料庫大小合理 (預期 ~50MB)
  - [ ] 文件權限正確

- [ ] **部署工具準備**
  - [ ] `deployment_tools/deploy.sh` 腳本可用
  - [ ] `deployment_tools/rollback.sh` 腳本可用
  - [ ] `deployment_tools/quick_health_check.py` 腳本可用

### 🧪 測試驗證
- [ ] **本地測試**
  - [ ] 健康檢查腳本運行正常
  - [ ] 資料庫連接測試通過
  - [ ] 查詢性能測試通過

- [ ] **品質檢查**
  - [ ] 資料庫品質測試通過 (80%+ 通過率)
  - [ ] 無關鍵錯誤 (P0 問題已解決)
  - [ ] 數據完整性檢查通過

### 📝 文檔準備
- [ ] **部署文檔**
  - [ ] 部署策略文檔完整
  - [ ] 回滾程序文檔完整
  - [ ] 監控程序文檔完整

- [ ] **團隊通知**
  - [ ] 部署時間窗口已確認
  - [ ] 相關人員已通知
  - [ ] 緊急聯絡方式已準備

---

## 🚀 部署執行檢查清單

### 📦 部署步驟
- [ ] **備份現有資料庫**
  ```bash
  # 執行備份
  cp /var/lib/prompt-scribe/tags.db /var/lib/prompt-scribe/backups/tags_backup_$(date +%Y%m%d_%H%M%S).db
  ```

- [ ] **停止應用服務**
  ```bash
  systemctl stop prompt-scribe-app
  ```

- [ ] **部署新資料庫**
  ```bash
  # 複製新資料庫
  cp output/tags.db /var/lib/prompt-scribe/tags.db
  
  # 設置權限
  chown prompt-scribe:prompt-scribe /var/lib/prompt-scribe/tags.db
  chmod 644 /var/lib/prompt-scribe/tags.db
  ```

- [ ] **啟動應用服務**
  ```bash
  systemctl start prompt-scribe-app
  ```

### ✅ 即時驗證
- [ ] **服務狀態檢查**
  ```bash
  systemctl status prompt-scribe-app
  ```

- [ ] **健康檢查**
  ```bash
  python3 stage1/deployment_tools/quick_health_check.py --db-path /var/lib/prompt-scribe/tags.db
  ```

- [ ] **基本功能測試**
  - [ ] 資料庫連接正常
  - [ ] 查詢響應時間 < 100ms
  - [ ] 無錯誤日誌

---

## 🔍 部署後驗證檢查清單

### 🧪 功能測試
- [ ] **核心功能驗證**
  - [ ] 標籤分類功能正常
  - [ ] 查詢功能正常
  - [ ] 統計功能正常

- [ ] **性能測試**
  - [ ] 查詢響應時間 < 50ms
  - [ ] 記憶體使用正常
  - [ ] CPU 使用正常

- [ ] **錯誤處理測試**
  - [ ] 無效查詢處理正常
  - [ ] 錯誤日誌記錄正常
  - [ ] 異常恢復正常

### 📊 監控檢查
- [ ] **系統監控**
  - [ ] 服務狀態監控正常
  - [ ] 資源使用監控正常
  - [ ] 錯誤率監控正常

- [ ] **業務監控**
  - [ ] 用戶訪問正常
  - [ ] 功能使用正常
  - [ ] 反饋收集正常

### 👥 用戶驗證
- [ ] **關鍵用戶測試**
  - [ ] 管理員功能正常
  - [ ] 開發者功能正常
  - [ ] 終端用戶功能正常

- [ ] **反饋收集**
  - [ ] 用戶滿意度檢查
  - [ ] 問題報告收集
  - [ ] 改進建議收集

---

## 🚨 緊急情況處理

### ⚠️ 回滾觸發條件
- [ ] 服務無法啟動
- [ ] 資料庫連接失敗
- [ ] 查詢性能嚴重下降 (>500ms)
- [ ] 錯誤率超過 5%
- [ ] 用戶大量投訴

### 🔄 回滾執行
- [ ] **停止應用服務**
  ```bash
  systemctl stop prompt-scribe-app
  ```

- [ ] **恢復備份**
  ```bash
  cp /var/lib/prompt-scribe/backups/tags_backup_*.db /var/lib/prompt-scribe/tags.db
  ```

- [ ] **重新啟動服務**
  ```bash
  systemctl start prompt-scribe-app
  ```

- [ ] **驗證回滾**
  ```bash
  python3 stage1/deployment_tools/quick_health_check.py
  ```

---

## 📞 聯絡資訊

### 👥 部署團隊
- **部署負責人**: [待指定]
- **技術支援**: [待指定]
- **監控負責人**: [待指定]

### 📱 緊急聯絡
- **緊急電話**: [待指定]
- **緊急郵件**: [待指定]
- **緊急群組**: [待指定]

### ⏰ 部署時間
- **部署窗口**: [待商定]
- **預計時長**: 30-60 分鐘
- **回滾時間**: < 5 分鐘

---

## 📝 部署記錄

### 部署歷史
| 版本 | 日期 | 負責人 | 狀態 | 備註 |
|------|------|--------|------|------|
| v1.0 | 2025-10-13 | [待填] | 待部署 | 初始生產版本 |

### 問題記錄
- [待記錄部署過程中的問題和解決方案]

### 改進建議
- [待記錄部署後的改進建議]

---

## ✅ 簽名確認

### 部署前確認
- **技術負責人**: _________________ 日期: ___________
- **專案經理**: _________________ 日期: ___________
- **QA 負責人**: _________________ 日期: ___________

### 部署後確認
- **部署執行人**: _________________ 日期: ___________
- **驗證負責人**: _________________ 日期: ___________
- **最終確認**: _________________ 日期: ___________

---

*此檢查清單將在部署過程中逐步完成並記錄*
